# 语法制导翻译与中间代码生成

语法制导翻译是处理语义的基本方法，它以语法分析为基础，在语法分析得到语言结构的结果时，对附着于此结构的语义进行处理，如计算表达式的值、生成中间代码等。

## 简介

- 语法和语义

  语法是语言的结构（样子）语义是附着在语言结构上的实际含义

  ①语义不能离开语法独立存在；

  ②语义远比语法复杂；

  ③同一语言结构可包含多种含义，不同语言结构可表示相同含义；

  ④语法与语义之间没有明确的界线。

- 语义分析的两个作用

  ①检查是否结构正确的句子所表示的意思也合法；

  ②执行规定的语义动作，如：

  õ表达式求值

  õ符号表填写

  õ中间代码生成等

- 语义分析的方法

  语法制导翻译

  程序的动态语义：公里语义、操作语义、指称语义，程序的动态语义不适用属性文法描述

## 语法制导翻译

通俗地讲，以语法分析为基础，伴随语法分析的各个步骤，执行相应的语义动作。

具体方法：

①将文法符号所代表的语言结构的意思，用附着于该文法符号的**属性**表示；

②用**语义规则**规定产生式所代表的语言结构之间的关系（即属性之间的关系），即用语义规则实现属性计算。

语义规则的执行：在语法分析的适当时刻（如推导或归约）执行附着在对应产生式上的语义规则，以实现对语言结构语义的处理，如计算、查填符号表、生成中间代码、发布出错信息等。

### 属性文法

在上下文无关文法的基础上，为每个文法符号，配 备若干相关的属性

- 属性代表与文法符号相关的信息，类型、代码、符号表
- 属性可以进行计算和传递
- 语义规则：对文法的每个产生式都配备了一组属性的计算规则

**说明**

- 终结符只有综合属性，由词法分析器提供
- 非终结符既可以有综合属性，也可以有继承属性



### LR 分析翻译

LR 分析中的语法制导翻译实质上是对LR 语法分析的扩充

- 扩充 LR 分析器的功能

  规约时执行语义动作

- 扩充分析栈

  增加了与分析栈并列的语义栈，存放分析栈中文法符号对应的属性值

## 中间代码

中间代码生成器输出的中间表示

中间代码的主要形式：树、后缀式、三地址码

### 后缀式

操作数在前，操作符紧随其后，不需用括号限制运算的优先级和结合性

### 三地址码

1.三地址码的直观表示

语法：result := arg1 op arg2 或

  result := op arg1 或 

  op arg1

2. 三地址码的种类

   ![](http://media.sumblog.cn/img/20190530171524.png-min_pic)

3. 三地址码的实现

   - 三地址码
   - 四地址码

### 图形表示

- 树作为中间代码
- 树的语法制导翻译
- 树和其他中间代码的关系
  - 对树进行后序遍历，得到后缀式
  - 树的每个内部节点和他的孩子对应一个三元式或四元式
  - 





## 声明语句的翻译

### 变量的声明

- 变量的类型定义与声明
  - **类型定义：** 为编译器
  - 提供存储空间大小的信息
  - **变量声明：** 为变量分配存储空间

1. 变量声明的文法
2. 填写符号表信息的语法制导翻译
   - 全程量 offset：记录当前符号存储的偏移量
   - 属性.type 和 .width 变量的类型和所占据的空间
   - 过程 enter(name, type , offset) 为 type 类型的变量 name 建立符号表条目，并为其分配存储空间







==要考的：布尔表达式的短路计算==

